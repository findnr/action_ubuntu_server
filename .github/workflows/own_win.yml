name: own_win
on:
  workflow_dispatch:
jobs:
  job1:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v3
    - name: install sougou wubi
      run: |
        $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
        $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
        $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougouwubi.exe" } | Select-Object -ExpandProperty browser_download_url
        Invoke-WebRequest -Uri $downloadUrl -OutFile sougouwubi.exe
        Start-Process -FilePath sougouwubi.exe -ArgumentList "/S" -NoNewWindow
    - name: install sougou pinyin
      run: | 
        $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
        $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
        $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougoupinyin.exe" } | Select-Object -ExpandProperty browser_download_url
        Invoke-WebRequest -Uri $downloadUrl -OutFile "sougoupinyin.exe"
        Start-Process -FilePath "sougoupinyin.exe" -ArgumentList "/S" -NoNewWindow
       
    - name: setting1 info qaz,123456
      env:
        ZEROTIER_ID: ${{ secrets.ZEROTIER_ID }}
      run: |
         $env:USERNAME
         Write-Host "downloading ZeroTier msi progra..."
         $installerPath = "$env:TEMP\ZeroTierInstaller.msi"
         Invoke-WebRequest -Uri "https://download.zerotier.com/dist/ZeroTier%20One.msi" -OutFile $installerPath
         Write-Host "install working ZeroTier..."
         Start-Process -FilePath "msiexec.exe" -ArgumentList "/i $installerPath /qn /norestart" -Wait
         cd 'C:\Program Files (x86)\ZeroTier\One\'
         ./zerotier_desktop_ui.exe
         Start-Sleep -Seconds 60
         ./zerotier-cli join "${env:ZEROTIER_ID}"
         Start-Sleep -Seconds 10
         ./zerotier-cli info
         ipconfig
         $currentUsername = $env:USERNAME
         $defaultPassword = ConvertTo-SecureString "qaz,123456" -AsPlainText -Force
         Set-LocalUser -Name $currentUsername -Password $defaultPassword
         Start-Sleep -Seconds 213000
job1:
  runs-on: windows-latest
  steps:
  - uses: actions/checkout@v3
  - name: install sougou wubi
    run: |
      $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
      $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
      $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougouwubi.exe" } | Select-Object -ExpandProperty browser_download_url
      Invoke-WebRequest -Uri $downloadUrl -OutFile sougouwubi.exe
      Start-Process -FilePath sougouwubi.exe -ArgumentList "/S" -NoNewWindow
  - name: install sougou pinyin
    run: | 
      $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
      $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
      $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougoupinyin.exe" } | Select-Object -ExpandProperty browser_download_url
      Invoke-WebRequest -Uri $downloadUrl -OutFile "sougoupinyin.exe"
      Start-Process -FilePath "sougoupinyin.exe" -ArgumentList "/S" -NoNewWindow
       
  - name: setting1 info qaz,123456
    env:
      ZEROTIER_ID: ${{ secrets.ZEROTIER_ID }}
    run: |
        $env:USERNAME
        Write-Host "downloading ZeroTier msi progra..."
        $installerPath = "$env:TEMP\ZeroTierInstaller.msi"
        Invoke-WebRequest -Uri "https://download.zerotier.com/dist/ZeroTier%20One.msi" -OutFile $installerPath
        Write-Host "install working ZeroTier..."
        Start-Process -FilePath "msiexec.exe" -ArgumentList "/i $installerPath /qn /norestart" -Wait
        cd 'C:\Program Files (x86)\ZeroTier\One\'
        ./zerotier_desktop_ui.exe
        Start-Sleep -Seconds 60
        ./zerotier-cli join "${env:ZEROTIER_ID}"
        Start-Sleep -Seconds 10
        ./zerotier-cli info
        ipconfig
        $currentUsername = $env:USERNAME
        $defaultPassword = ConvertTo-SecureString "qaz,123456" -AsPlainText -Force
        Set-LocalUser -Name $currentUsername -Password $defaultPassword
        Start-Sleep -Seconds 213000
  job2:
    needs: job1
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v3
    - name: install sougou wubi
      run: |
        $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
        $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
        $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougouwubi.exe" } | Select-Object -ExpandProperty browser_download_url
        Invoke-WebRequest -Uri $downloadUrl -OutFile sougouwubi.exe
        Start-Process -FilePath sougouwubi.exe -ArgumentList "/S" -NoNewWindow
    - name: install sougou pinyin
      run: | 
        $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
        $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
        $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougoupinyin.exe" } | Select-Object -ExpandProperty browser_download_url
        Invoke-WebRequest -Uri $downloadUrl -OutFile "sougoupinyin.exe"
        Start-Process -FilePath "sougoupinyin.exe" -ArgumentList "/S" -NoNewWindow
       
    - name: setting1 info qaz,123456
      env:
        ZEROTIER_ID: ${{ secrets.ZEROTIER_ID }}
      run: |
         $env:USERNAME
         Write-Host "downloading ZeroTier msi progra..."
         $installerPath = "$env:TEMP\ZeroTierInstaller.msi"
         Invoke-WebRequest -Uri "https://download.zerotier.com/dist/ZeroTier%20One.msi" -OutFile $installerPath
         Write-Host "install working ZeroTier..."
         Start-Process -FilePath "msiexec.exe" -ArgumentList "/i $installerPath /qn /norestart" -Wait
         cd 'C:\Program Files (x86)\ZeroTier\One\'
         ./zerotier_desktop_ui.exe
         Start-Sleep -Seconds 60
         ./zerotier-cli join "${env:ZEROTIER_ID}"
         Start-Sleep -Seconds 10
         ./zerotier-cli info
         ipconfig
         $currentUsername = $env:USERNAME
         $defaultPassword = ConvertTo-SecureString "qaz,123456" -AsPlainText -Force
         Set-LocalUser -Name $currentUsername -Password $defaultPassword
         Start-Sleep -Seconds 213000
  job3:
    needs: [job1, job2]
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v3
    - name: install sougou wubi
      run: |
        $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
        $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
        $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougouwubi.exe" } | Select-Object -ExpandProperty browser_download_url
        Invoke-WebRequest -Uri $downloadUrl -OutFile sougouwubi.exe
        Start-Process -FilePath sougouwubi.exe -ArgumentList "/S" -NoNewWindow
    - name: install sougou pinyin
      run: | 
        $url = "https://api.github.com/repos/${{ github.repository }}/releases/latest"
        $release = Invoke-RestMethod -Uri $url -Headers @{"Authorization"="Bearer ${{ secrets.GITHUB_TOKEN }}"} 
        $downloadUrl = $release.assets | Where-Object { $_.name -eq "sougoupinyin.exe" } | Select-Object -ExpandProperty browser_download_url
        Invoke-WebRequest -Uri $downloadUrl -OutFile "sougoupinyin.exe"
        Start-Process -FilePath "sougoupinyin.exe" -ArgumentList "/S" -NoNewWindow
       
    - name: setting1 info qaz,123456
      env:
        ZEROTIER_ID: ${{ secrets.ZEROTIER_ID }}
      run: |
         $env:USERNAME
         Write-Host "downloading ZeroTier msi progra..."
         $installerPath = "$env:TEMP\ZeroTierInstaller.msi"
         Invoke-WebRequest -Uri "https://download.zerotier.com/dist/ZeroTier%20One.msi" -OutFile $installerPath
         Write-Host "install working ZeroTier..."
         Start-Process -FilePath "msiexec.exe" -ArgumentList "/i $installerPath /qn /norestart" -Wait
         cd 'C:\Program Files (x86)\ZeroTier\One\'
         ./zerotier_desktop_ui.exe
         Start-Sleep -Seconds 60
         ./zerotier-cli join "${env:ZEROTIER_ID}"
         Start-Sleep -Seconds 10
         ./zerotier-cli info
         ipconfig
         $currentUsername = $env:USERNAME
         $defaultPassword = ConvertTo-SecureString "qaz,123456" -AsPlainText -Force
         Set-LocalUser -Name $currentUsername -Password $defaultPassword
         Start-Sleep -Seconds 213000

